# --- åŸºç¡€è®¾ç½® ---
set -g status-style bg=default 
set -g base-index 1
setw -g pane-base-index 1
setw -g mode-keys vi

set -g status-right "#(hostname -I | awk '{print $1}') #(cat /sys/class/power_supply/BAT0/capacity)% %m-%d %H:%M"

# è™½ç„¶æˆ‘ä»¬ä¸»è¦ç”¨ Alt é”®ï¼Œä½†ä¿ç•™ä¸€ä¸ª Prefix ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ (å¦‚åµŒå¥— tmux æ—¶)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# --- æ ¸å¿ƒï¼šåŽ»å‰ç¼€åŒ–ç»‘å®š (ä½¿ç”¨ -n å‚æ•°) ---
# æ³¨æ„ï¼šM ä»£è¡¨ Alt é”® (Meta)

# 1. çª—å£åˆ†å‰² (Split) -> Alt + \ å’Œ Alt + -
unbind %
unbind '"'
bind -n M-\\ split-window -h -c "#{pane_current_path}"
bind -n M-- split-window -v -c "#{pane_current_path}"

bind -n M-Space select-pane -t :.+

# 3. é¢æ¿è°ƒæ•´å¤§å° (Resize) -> Alt + Shift + æ–¹å‘é”®
bind -n M-S-Left resize-pane -L 5
bind -n M-S-Right resize-pane -R 5
bind -n M-S-Up resize-pane -U 5
bind -n M-S-Down resize-pane -D 5

# 4. å¤åˆ¶æ¨¡å¼ä¸Žç²˜è´´ (Copy Mode)
# å»ºè®®ï¼šä½¿ç”¨ Alt + v è¿›å…¥å¤åˆ¶æ¨¡å¼ï¼ŒAlt + p ç²˜è´´
bind -n M-v copy-mode
bind -n M-p paste-buffer

# å¤åˆ¶æ¨¡å¼å†…éƒ¨çš„æŒ‰é”® (Copy Mode VI key table)
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -i && tmux display-message 'Content copied to clipboard!'"
bind-key -T copy-mode-vi Escape send-keys -X cancel

# 5. çª—å£ç®¡ç† (Window Management)
# é‡å‘½å -> Alt + r
bind -n M-r command-prompt -I "#W" "rename-window '%%'"

# åˆ›å»ºæ–°çª—å£ -> Alt + c
bind -n M-c new-window -c "#{pane_current_path}"

# å…³é—­å½“å‰é¢æ¿/çª—å£ -> Alt + x
bind -n M-x kill-pane

# --- è¡¥å……çš„é«˜é¢‘æ“ä½œ (å…¨éƒ¨åŽ»å‰ç¼€) ---

# 1. æœ€å¤§åŒ–/æ¢å¤å½“å‰é¢æ¿ (Zoom) -> Alt + z
bind -n M-z resize-pane -Z

# 2. ä¼šè¯é€‰æ‹©å™¨ (Session Switcher) -> Alt + s
bind -n M-s choose-session

# 3. å¿«é€Ÿé‡è½½é…ç½®æ–‡ä»¶ -> Alt + R (Shift + r)
bind -n M-R source-file ~/.config/tmux/tmux.conf \; display "Config Reloaded!"

# 6. çª—å£åˆ‡æ¢ (Switch Window) - ä¿®æ”¹éƒ¨åˆ†
bind -n M-q previous-window
bind -n M-w next-window

# --- è„šæœ¬ä¸Žå·¥å…·ç»‘å®š ---

bind -n M-/ display-popup -E -w 60% -h 60% "bash $HOME/.config/tmux/scripts/quick-prompts/quick-prompts.sh"

bind -n M-m run-shell -b "killall mpv >/dev/null 2>&1 || true; mpv --no-video --shuffle ~/Music >/dev/null 2>&1 & tmux display-message 'ðŸŽµ Playing Music'; true"
bind -n M-. run-shell -b "killall mpv >/dev/null 2>&1 && tmux display-message 'ðŸ›‘ Music Stopped'; true"

bind -n C-o display-popup -E -w 60% -h 60% "bash $HOME/.config/tmux/scripts/quick-commands/quick-commands.sh"
